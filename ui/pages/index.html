<!--
Copyright (c) 2023, Development_Practices_Team
All rights reserved.
-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>
        <%= htmlWebpackPlugin.options.title %>
    </title>
</head>

<body>
    <div id="loader"></div>
    <div id="app">
            <button id="myButton">Call Function</button>

        <main-card title="Distribution of active subscriptions per marketplace">
            <div class="main-container">
                <div id="chart">
                </div>
                <div>
                    <div class="list-wrapper">
                        <ul id="marketplaces" class="list">
                        </ul>
                    </div>
                </div>
            </div>
        </main-card>
    </div>
<script>
        document.getElementById("myButton").addEventListener("click", function() {
                    // Open a blank window/tab
            const popup = window.open('', '_blank');

            // Send a request to the endpoint when the button is clicked
            fetch('/api/wizardo')
                .then(response => response.text())
                .then(data => {
                    // Parse the returned URL from the response
                    const redirectUrl = data.trim();
                    // Set the URL of the opened window/tab
                    popup.location.href = redirectUrl;
                })
                .catch(error => {
                    // Handle errors
                    console.error('There was an error!', error);
                    popup.close(); // Close the window/tab in case of an error
                });
        });
  </script>
</body>

</html>
